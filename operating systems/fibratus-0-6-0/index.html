<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Fibratus 0.6.0 &#8211; Rabbit Stack</title>
<meta name="description" content="I'm happy to announce the release of Fibratus 0.6.0. Let's see what's new in this version.">
<meta name="keywords" content="operating systems, windows, kernel, system calls, exploration, python, cython, tracing, portable executable">



<!-- Twitter Cards -->
<meta name="twitter:title" content="Fibratus 0.6.0">
<meta name="twitter:description" content="I'm happy to announce the release of Fibratus 0.6.0. Let's see what's new in this version.">



<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://rabbitstack.github.io/images/rabbit-bkgd.jpg">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Fibratus 0.6.0">
<meta property="og:description" content="I'm happy to announce the release of Fibratus 0.6.0. Let's see what's new in this version.">
<meta property="og:url" content="http://rabbitstack.github.io/operating%20systems/fibratus-0-6-0/">
<meta property="og:site_name" content="Rabbit Stack">





<link rel="canonical" href="http://rabbitstack.github.io/operating%20systems/fibratus-0-6-0/">
<link href="http://rabbitstack.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="Rabbit Stack Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://rabbitstack.github.io/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="http://rabbitstack.github.io/assets/js/vendor/html5shiv.min.js"></script>
	<script src="http://rabbitstack.github.io/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="http://rabbitstack.github.io/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700%7CPT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Ubuntu+Mono' rel='stylesheet' type='text/css'>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://rabbitstack.github.io/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://rabbitstack.github.io/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://rabbitstack.github.io/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://rabbitstack.github.io/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://rabbitstack.github.io/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://rabbitstack.github.io/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body class="post">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
		<div class="site-name">
			<!-- <img src="/images/rabbit-small.jpg" alt="Rabbit Stack logo" class="logo" /> -->
			<!-- <a href="http://rabbitstack.github.io/">Rabbit Stack</a> -->
			<a href="http://rabbitstack.github.io/"><span class="site-name-segment">Rabbit</span> <span class="big-font">Stack</span></a>

		</div><!-- /.site-name -->

	
	
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav">
		    <ul>
		        
				    
				        
				    
				    <li><a href="http://rabbitstack.github.io#" >Home</a></li>
				
				    
				        
				    
				    <li><a href="http://rabbitstack.github.io/posts/" >Archive</a></li>
				
				    
				        
				    
				    <li><a href="http://rabbitstack.github.io/about/" >About</a></li>
				
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->


  <div class="image-wrap">
  <img class="bkg" src=
    
      "http://rabbitstack.github.io/images/rabbit-bkgd.jpg"
    
  alt="Fibratus 0.6.0 feature image">
  
       <div class="headline-wrap">
          <img src="http://rabbitstack.github.io/images/rabbitstack.png" />
          <h1> The place where bunnies dwell </h1>
          <h2> And bits become colossal </h2>
      </div>
  </div><!-- /.image-wrap -->


<div id="main" role="main">
  <article class="post">
    <div class="headline-wrap">
      
        <h1><a href="http://rabbitstack.github.io/operating%20systems/fibratus-0-6-0/" rel="bookmark" title="Fibratus 0.6.0">Fibratus 0.6.0</a></h1>
      
    </div><!--/ .headline-wrap -->
    <div class="article-wrap">
      <p>I’m happy to announce the release of <strong>Fibratus 0.6.0</strong>. Let’s see what’s new in this version.</p>

<h3 id="whats-new">What’s new</h3>

<h4 id="high-performance-kernel-event-stream-collector">High performance kernel event stream collector</h4>

<p>The kernel event stream collector has been rewritten from ground up. It now operates without <strong>GIL</strong> (Global Interpreter Lock) limitations which makes the Python interpreter capable of executing the byte code in parallel. The result is an ultra fast kernel event processing component!
The tricky part about releasing the GIL is that you can’t use any Python constructs before acquiring the GIL again. Such a simple operation as comparing strings has to be done by calling the function from the standard C library. Standard Python’s containers like <code>list</code> or <code>dict</code> had been replaced with analogous C++ <code>vector</code> and <code>unordered_map</code> containers.
If you look at the source tree, you should notice the <strong>kstream</strong> directory has changed dramatically. This refactoring will make it easier adding new features to the kernel event stream collector.</p>

<h4 id="image-meta-information">Image meta information</h4>

<p>Fibratus now supports querying the executable binary files for the <strong>PE</strong> (Portable Executable) headers. The <code>CreateProcess</code> kernel events can be enriched with a plethora of interesting info like binary sections, the imported symbols, file information, linkage time stamp, etc. Here is the JSON representation of the image meta information for the <code>cmd.exe</code> binary:</p>

<div class="highlight"><pre><code class="language-json" data-lang="json"><span class="s2">&quot;image_meta&quot;</span><span class="err">:</span><span class="p">{</span>  
         <span class="nt">&quot;internal_name&quot;</span><span class="p">:</span><span class="s2">&quot;cmd&quot;</span><span class="p">,</span>
         <span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="s2">&quot;0x57899A99 [Sat Jul 16 02:23:21 2016 UTC]&quot;</span><span class="p">,</span>
         <span class="nt">&quot;imports&quot;</span><span class="p">:{</span>  
            <span class="nt">&quot;api-ms-win-core-libraryloader-l1-2-0.dll&quot;</span><span class="p">:[</span>  
               <span class="s2">&quot;GetModuleFileNameW&quot;</span><span class="p">,</span>
               <span class="s2">&quot;GetModuleHandleW&quot;</span><span class="p">,</span>
               <span class="s2">&quot;LoadLibraryExW&quot;</span><span class="p">,</span>
               <span class="s2">&quot;GetProcAddress&quot;</span>
            <span class="p">],</span>
            <span class="nt">&quot;api-ms-win-core-timezone-l1-1-0.dll&quot;</span><span class="p">:[</span>  
               <span class="s2">&quot;SystemTimeToFileTime&quot;</span><span class="p">,</span>
               <span class="s2">&quot;FileTimeToSystemTime&quot;</span>
            <span class="p">],</span>
            <span class="err">...</span>
         <span class="p">},</span>
         <span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="s2">&quot;Windows Command Processor&quot;</span><span class="p">,</span>
         <span class="nt">&quot;copyright&quot;</span><span class="p">:</span><span class="s2">&quot;\\xa9 Microsoft Corporation. All rights reserved.&quot;</span><span class="p">,</span>
         <span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="s2">&quot;10.0.14393.0 (rs1_release.160715-1616)&quot;</span><span class="p">,</span>
         <span class="nt">&quot;org&quot;</span><span class="p">:</span><span class="s2">&quot;Microsoft Corporation&quot;</span><span class="p">,</span>
         <span class="nt">&quot;arch&quot;</span><span class="p">:</span><span class="s2">&quot;x86-64&quot;</span><span class="p">,</span>
         <span class="nt">&quot;sections&quot;</span><span class="p">:[</span>  
            <span class="p">{</span>  
               <span class="nt">&quot;md5&quot;</span><span class="p">:</span><span class="s2">&quot;64a67cc3d9162fc0e8f3e342498b5521&quot;</span><span class="p">,</span>
               <span class="nt">&quot;sha512&quot;</span><span class="p">:</span><span class="s2">&quot;a0f211244eb057bd57100a2bba4010a71b675f47571198004c66597f2d833086bf3aa1c3c4d97635185880f1ef42b45ce2d351f0d3f2bbe24a5b9e9841f38422&quot;</span><span class="p">,</span>
               <span class="nt">&quot;sha256&quot;</span><span class="p">:</span><span class="s2">&quot;90bdb2677504f970636f313b32963a7fb6e4a95fefa19a2fae97a783ee3bd24d&quot;</span><span class="p">,</span>
               <span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;.text&quot;</span><span class="p">,</span>
               <span class="nt">&quot;sha1&quot;</span><span class="p">:</span><span class="s2">&quot;59bef951b3e13ddf53778ad0eae69b32c65cebbf&quot;</span><span class="p">,</span>
               <span class="nt">&quot;entropy&quot;</span><span class="p">:</span><span class="mf">6.414245618720535</span>
            <span class="p">},</span>
            <span class="p">{</span>  
               <span class="nt">&quot;md5&quot;</span><span class="p">:</span><span class="s2">&quot;1e99e85eb32e35b18a9741e2b83f75fd&quot;</span><span class="p">,</span>
               <span class="nt">&quot;sha512&quot;</span><span class="p">:</span><span class="s2">&quot;ceedd390297dbcea20dd9065567fcf7138cd421007f7f57793e4f2b043c9137720d55ad7fee8ca5a687bb308759df48e001b2258578e69494a0661ee189a504c&quot;</span><span class="p">,</span>
               <span class="nt">&quot;sha256&quot;</span><span class="p">:</span><span class="s2">&quot;0a17d6c0cdc1a52ea16364787979c1fc4145e82e56ae59620fe7fdc04cc7eec7&quot;</span><span class="p">,</span>
               <span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;.rdata&quot;</span><span class="p">,</span>
            <span class="err">...</span>
         <span class="err">],</span>
         <span class="nt">&quot;num_sections&quot;</span><span class="p">:</span><span class="mi">7</span>
      <span class="p">}</span></code></pre></div>

<h4 id="multiple-output-sinks">Multiple output sinks</h4>

<p>The kernel events can now be streamed to multiple output sinks like message brokers, <strong>Elasticsearch</strong> instances and of course the standard output. In the previous version of Fibratus you had to rely on <strong>filaments</strong> to transport the event payloads to remote endpoints.</p>

<p>Beside this relevant features, there been done a ton of code refactoring and other improvements. For example, the bootstrap stage logs a lot of useful information, like the <strong>skips</strong> being applied, the <strong>outputs</strong> and its configuration, total boot time, etc.</p>

<div class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">[</span><span class="mi">2017-01-22</span> <span class="mi">20</span><span class="err">:</span><span class="mi">11</span><span class="err">:</span><span class="mf">29.423254</span><span class="p">]</span> <span class="err">INFO:</span> <span class="err">Fibratus:</span> <span class="err">Starting</span> <span class="err">Fibratus...</span>
<span class="p">[</span><span class="mi">2017-01-22</span> <span class="mi">20</span><span class="err">:</span><span class="mi">11</span><span class="err">:</span><span class="mf">29.423254</span><span class="p">]</span> <span class="err">INFO:</span> <span class="err">Fibratus:</span> <span class="err">Enumerating</span> <span class="err">system</span> <span class="err">handles...</span>
<span class="p">[</span><span class="mi">2017-01-22</span> <span class="mi">20</span><span class="err">:</span><span class="mi">11</span><span class="err">:</span><span class="mf">31.628521</span><span class="p">]</span> <span class="err">INFO:</span> <span class="err">Fibratus:</span> <span class="mi">6352</span> <span class="err">handles</span> <span class="err">found</span>
<span class="p">[</span><span class="mi">2017-01-22</span> <span class="mi">20</span><span class="err">:</span><span class="mi">11</span><span class="err">:</span><span class="mf">31.644142</span><span class="p">]</span> <span class="err">INFO:</span> <span class="err">Fibratus:</span> <span class="err">Adding</span> <span class="err">skips</span> <span class="err">for</span> <span class="err">images</span> <span class="p">[</span><span class="err">&#39;svchost.exe&#39;</span><span class="p">,</span> <span class="err">&#39;smss.exe&#39;</span><span class="p">,</span> <span class="err">&#39;services.exe&#39;</span><span class="p">,</span> <span class="err">&#39;taskmgr.exe&#39;</span><span class="p">,</span> <span class="err">&#39;dwm.exe&#39;</span><span class="p">,</span> <span class="err">&#39;vprot.exe&#39;</span><span class="p">,</span> <span class="err">&#39;lsass.exe&#39;</span><span class="p">,</span> <span class="err">&#39;sihost.exe&#39;</span><span class="p">,</span> <span class="err">&#39;system&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2017-01-22</span> <span class="mi">20</span><span class="err">:</span><span class="mi">11</span><span class="err">:</span><span class="mf">31.659769</span><span class="p">]</span> <span class="err">INFO:</span> <span class="err">Fibratus:</span> <span class="err">Deploying</span> <span class="p">[</span><span class="err">console</span><span class="p">]</span> <span class="err">output</span> <span class="err">-</span> <span class="p">[{</span><span class="err">&#39;format&#39;:</span> <span class="err">&#39;json&#39;</span><span class="p">}]</span>
<span class="p">[</span><span class="mi">2017-01-22</span> <span class="mi">20</span><span class="err">:</span><span class="mi">11</span><span class="err">:</span><span class="mf">31.659769</span><span class="p">]</span> <span class="err">INFO:</span> <span class="err">Fibratus:</span> <span class="err">Deploying</span> <span class="p">[</span><span class="err">elasticsearch</span><span class="p">]</span> <span class="err">output</span> <span class="err">-</span> <span class="p">[{</span><span class="err">&#39;bulk&#39;:</span> <span class="err">False,</span> <span class="err">&#39;hosts&#39;:</span> <span class="err">[&#39;localhost:9200&#39;],</span> <span class="err">&#39;ssl&#39;:</span> <span class="err">False,</span> <span class="err">&#39;document&#39;:</span> <span class="err">&#39;threads&#39;,</span> <span class="err">&#39;username&#39;:</span> <span class="err">None,</span> <span class="err">&#39;index&#39;:</span> <span class="err">&#39;fibratus&#39;</span><span class="p">}]</span>
<span class="p">[</span><span class="mi">2017-01-22</span> <span class="mi">20</span><span class="err">:</span><span class="mi">11</span><span class="err">:</span><span class="mf">31.728789</span><span class="p">]</span> <span class="err">INFO:</span> <span class="err">Fibratus:</span> <span class="err">Started</span> <span class="err">in</span> <span class="mi">0</span><span class="err">m:</span><span class="mi">02</span><span class="err">s.</span><span class="mi">2321</span></code></pre></div>

<p>If you have any feedback or would like to contribute you can reach out via <a href="https://github.com/rabbitstack/fibratus/issues">Github</a> or drop me an email.</p>

      <hr />
      <footer role="contentinfo">
        <div class="social-share">
  <h4>Share on</h4>
  <ul>
    <li>
      <a href="https://twitter.com/intent/tweet?text=http://rabbitstack.github.io/operating%20systems/fibratus-0-6-0/" class="twitter" title="Share on Twitter"><i class="fa fa-twitter"></i><span> Twitter</span></a>
    </li>
    <li>
      <a href="https://www.facebook.com/sharer/sharer.php?u=http://rabbitstack.github.io/operating%20systems/fibratus-0-6-0/" class="facebook" title="Share on Facebook"><i class="fa fa-facebook"></i><span> Facebook</span></a>
    </li>
    <li>
      <a href="https://plus.google.com/share?url=http://rabbitstack.github.io/operating%20systems/fibratus-0-6-0/" class="google-plus" title="Share on Google Plus"><i class="fa fa-google-plus"></i><span> Google+</span></a>
    </li>
  </ul>
</div><!-- /.social-share -->
        <p class="byline"><strong>Fibratus 0.6.0</strong> was published on <time datetime="2017-01-23T15:31:35+01:00">January 23, 2017</time>.</p>
      </footer>
    </div><!-- /.article-wrap -->
  
    <section id="disqus_thread">
        
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'rabbitstack'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    </section><!-- /#disqus_thread -->
  
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="http://rabbitstack.github.io/posts/">View all posts</a>)</small></h4>
    <ul>
    
      <li><a href="http://rabbitstack.github.io/operating%20systems/fibratus-0-7-0/" title="Fibratus 0.7.0">Fibratus 0.7.0</a></li>
    
      <li><a href="http://rabbitstack.github.io/operating%20systems/fibratus-0-4-0/" title="Fibratus 0.4.0">Fibratus 0.4.0</a></li>
    
      <li><a href="http://rabbitstack.github.io/operating%20systems/fibratus-0-3-0/" title="Fibratus 0.3.0">Fibratus 0.3.0</a></li>
    
    </ul>
    <hr />
  </div><!-- /.related-articles -->

  <footer>
    

<span>&copy; 2017 Nedim Šabić. Rabbit Stack blog is powered by Jekyll. Bunny icon is courtesy of <a href="http://www.freepik.com" title="Freepik">Freepik.</a>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://rabbitstack.github.io/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://rabbitstack.github.io/assets/js/plugins/jquery.magnific-popup.js"></script>
<script src="http://rabbitstack.github.io/assets/js/scripts.min.js"></script>

<!-- Asynchronous Google Analytics snippet -->
<script>
  var _gaq = _gaq || [];
  var pluginUrl =
 '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'rabbitstack']);
  _gaq.push(['_trackPageview']);

  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61212549-1', 'auto');
  ga('send', 'pageview');

  $(document).ready(function() {
     $('.image-popup').magnificPopup({type:'image'});
  });
</script>


  
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'rabbitstack'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>




</body>
</html>
